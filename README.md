# Применение алгоритма Рунге-Кутты 4-го порядка в задаче моделирования физических процессов описываемых ОДУ второго порядка

### Земной маятник

Через центр Земли просверлено отверстие, в которое направляют небольшое тело. Смоделировать движение этого тела при различных начальных скоростях (в том числе и при скорости, направленной от Земли). Трение не учитывать. Определить период колебаний и максимальную скорость тела.

- Задача 1. Считать Землю идеальным шаром с равномерно распределенной плотностью, равной средней плотности Земли.

- Задача 2. Считать, что у Земли есть ядро радиусом R/2 c плотностью в 2 раза превышающей плотность внешней оболочки. Значения плотностей рассчитать из условия неизменности массы Земли.

<p align="center">
<img width="210" height="236" src="https://github.com/user-attachments/assets/61882f19-e643-465d-b31c-1c3e0a778ac3" />
</p>

## Методические указания

**1. Составление физической модели задачи.**

На этом этапе необходимо нарисовать схему задачи, указать силы, записать 2-й закон Ньютона для движущегося тела (или тел) в произвольной точке траектории, записать формулы для всех сил, действующих на тело, записать физические константы и заданные параметры задачи (например, в системе СИ).

**2. Составление математической модели задачи.**

На этом этапе выбирается система координат. Удобнее всего взять декартову 2-х мерную (а в некоторых задачах 3-х мерную) систему координат. Далее записываются проекции 2-го закона Ньютона на оси выбранной системы координат; тем самым получается система 2-х или 3-х дифференциальных уравнений второго порядка для последующего расчета координат движущегося тела в заданные моменты времени. Здесь же задаются начальные условия задачи, т.е. начальные координаты и проекции начальных скоростей.

**3. Выбор метода численного решения.**

Методов численного решения системы обыкновенных дифференциальных уравнений много. Можно использовать любой из них, обеспечивающий хорошую точность при достижении малых затрат машинного времени. Рекомендуется использовать метод Рунге-Кутты 4-го порядка для решения дифференциального уравнения 2-го порядка вида 

$$
x''=f(t,x,x') \quad при \quad x(0)=x_0, \quad x'(0)=v_{x0}
$$


Шаг по времени $Δt$ выбирается в два этапа. Сначала оценивается его грубое значение, как $0.001÷0.01$ от характерного времени задачи (периода обращения, периода колебаний и т.д.). Далее  $Δt$ уточняют из пробных расчетов по программе таким образом, что в случае отсутствия сопротивления атмосферы или сил трения закон сохранения механической энергии для всех моментов времени выполнялся с точностью не хуже 1–2%.

**4. Составление программы расчетов.**

Программа должна иметь удобный интерфейс для ввода и изменения параметров задачи, а также для вывода результатов. Наиболее удобно представлять движение тела в виде анимации, показывая траекторию за предыдущие моменты времени. Кадры анимации можно выводить на экран через один или несколько шагов по времени, добиваясь движения без заметных рывков. 

## **Среда разработки**
- Visual Studio 2022 с компонентами:
  - "Разработка классических приложений на C++"
  - "Пакет SDK для Windows 10/11"
  - "MSVC версии 141 - средства сборки C++"
  - "MSVC версии 141 - библиотеки C++"

## Результат работы программы
### Gif
||$v = 0$|$v = 7000$|
|:------------------------:|:------------------------:|:------------------------:|
|1.|![1](https://github.com/user-attachments/assets/9d7f4d80-0b6f-4262-b47a-1ee08129bf10)|![2](https://github.com/user-attachments/assets/1d613c18-9da7-4609-9024-ade0cc16f178)|
|2.|![3](https://github.com/user-attachments/assets/8111d1a3-4abb-4132-bd79-f395e47c3bc8)|![4](https://github.com/user-attachments/assets/a4645900-929b-423f-8034-835bbb4187b5)|

### Image
||$v = 0$|$v = 7000$|
|:------------------------:|:------------------------:|:------------------------:|
|1.|![1](https://github.com/user-attachments/assets/dcfb29c1-e8fe-458c-a871-0dc9a66462b6)|![2](https://github.com/user-attachments/assets/d452ff57-cb62-42e4-9c5f-319cf3af0f6d)|
|2.|![3](https://github.com/user-attachments/assets/540ea2a4-e5d3-482c-8c91-94aafac991ac)|![4](https://github.com/user-attachments/assets/704865cf-80db-41d2-b9b0-36b86c73ea90)|

<p align="center">
<img src="https://github.com/user-attachments/assets/13c30c28-214b-4d43-afe3-0300d2ff2885" />
</p>

## Литература
- А.С. Васин – Применение численных методов к моделированию физических процессов: Практикум - Нижний Новгород: Издательство Нижегородского госуниверситета, 2021. – 44 с.
